# .cursorrules - ReqMind

> **Vers√£o:** 1.0  
> **Prop√≥sito:** Alinhar o comportamento do Cursor AI √†s regras globais do ReqMind (Next.js 15, TypeScript strict, Tailwind, Supabase/Neon, Drizzle, Zod, T3 Env, Nuqs, OWASP Top 10).

---

## üìä Informa√ß√µes do Projeto

- **Stack principal:** Next.js 15 (App Router, Server Components por padr√£o)
- **Linguagem:** TypeScript (Strict Mode)
- **Estiliza√ß√£o:** Tailwind CSS + Shadcn/ui
- **Banco de Dados:** Supabase (PostgreSQL) ou Neon
- **ORM:** Drizzle ORM
- **Autentica√ß√£o:** Supabase Auth ou Clerk
- **Gerenciamento de Estado:** Nuqs (URL state) antes de `useState`

---

## üéØ Regras de Performance e Contexto (`<context_management>`)

### Limites de Contexto

- **Prioridade de arquivos:**
  1. Arquivo atual em edi√ß√£o.
  2. Arquivos abertos recentemente (at√© 5).
  3. Depend√™ncias diretas do arquivo atual (imports/exports).
  4. Arquivos referenciados explicitamente via `@`.
- **Foco em s√≠mbolos:** ao analisar arquivos, focar apenas nas fun√ß√µes, classes e componentes diretamente relevantes. Evitar carregar arquivos inteiros quando apenas um s√≠mbolo √© necess√°rio.
- **Exclus√µes padr√£o:** ignorar por padr√£o arquivos de teste (`.test.`, `.spec.`), configura√ß√£o (`.config.`, `.json`, `.yaml`) e documenta√ß√£o (`.md`), **a menos** que sejam mencionados explicitamente pelo usu√°rio.
- **M√°ximo de arquivos ativos:** manter no m√°ximo **3 arquivos** no contexto simultaneamente para tarefas rotineiras. Expandir apenas quando explicitamente solicitado.

### Or√ßamento de Resposta (`<response_budget>`)

- **Respostas padr√£o (c√≥digo/ajuste pontual):** at√© **800 tokens**.
- **Debugging simples (fix + breve nota):** at√© **1200 tokens**.
- **An√°lise/refatora√ß√£o complexa:** at√© **2000 tokens**, somente quando o usu√°rio pedir an√°lise detalhada.

---

## üíª Conven√ß√µes de C√≥digo (`<coding_conventions>`)

### Arquitetura e Estrutura

- **Padr√£o de pastas do projeto:**
  - `src/app/`: rotas e layouts do Next.js (App Router).
  - `src/features/`: funcionalidades organizadas por feature.
    - Cada feature pode conter: `components/`, `hooks/`, `actions.ts`, `.context.md`.
  - `src/server/`: l√≥gicas de neg√≥cio reutiliz√°veis.
  - `src/lib/`: utilit√°rios globais (`db.ts`, `env.ts`, `cn.ts` etc.).
  - `src/components/`: componentes de UI globais.
    - `src/components/ui/`: componentes Shadcn/ui reutiliz√°veis.

### Padr√µes Obrigat√≥rios

- **Componentes React:**
  - Server Components por padr√£o.
  - Usar `"use client"` **apenas quando estritamente necess√°rio** (intera√ß√µes no client, hooks de browser etc.).
  - Componentes com no m√°ximo **150 linhas**.
- **Fun√ß√µes:**
  - Fun√ß√µes com no m√°ximo **30 linhas** de implementa√ß√£o.
  - Complexidade ciclom√°tica < 10 por fun√ß√£o.
- **Tipagem e props:**
  - Props sempre tipadas, nunca usar `any`.
  - Hooks customizados com prefixo `use`.
- **Estado e hooks:**
  - Preferir **Nuqs (URL state)** em vez de `useState` para estado que impacta URL/filters.
  - `useState` apenas quando Nuqs n√£o fizer sentido.
- **Handlers:**
  - Usar `useCallback` para handlers passados para componentes filhos.

### Regras de Seguran√ßa e Valida√ß√£o (OWASP Top 10)

- **Zod obrigat√≥rio para inputs:**
  - Qualquer entrada de usu√°rio (forms, query params, body de requisi√ß√£o) deve ser validada com **Zod** antes de qualquer processamento.
- **T3 Env obrigat√≥rio para envs:**
  - Nunca acessar `process.env` diretamente. Sempre usar T3 Env para valida√ß√£o e acesso a vari√°veis de ambiente.
- **Server Actions e backend:**
  - Muta√ß√£o de dados sempre via **Server Actions** ou rotas de API, nunca em Client Components.
  - Server Actions cr√≠ticas (auth, billing, APIs p√∫blicas) devem ter **rate limiting**.
- **Autentica√ß√£o e autoriza√ß√£o:**
  - L√≥gica de autentica√ß√£o isolada na feature `auth`.
  - Sempre verificar permiss√µes de usu√°rio em Server Actions antes de acessar ou modificar dados.
- **Tratamento de erros:**
  - Padr√£o de retorno: `{ success: boolean, message?: string, data?: T }`.
  - N√£o expor detalhes sens√≠veis de erros em respostas para o client.

### Proibido

- Prop drilling em mais de 2 n√≠veis (usar contexto, hooks ou composi√ß√£o).
- `console.log` em produ√ß√£o (usar logger estruturado).
- C√≥digo comentado ‚Äúmorto‚Äù (remover ou documentar em `.context.md`).
- Magic numbers (usar constantes nomeadas).
- Armazenar dados sens√≠veis em client-side sem necessidade expl√≠cita.

---

## üîß Debugging e Resolu√ß√£o de Problemas (`<error_decision_framework>`)

### Fluxo para Erros

1. Identificar a causa raiz em no m√°ximo 3 linhas de racioc√≠nio interno.
2. Propor o **fix direto no c√≥digo**, sem explica√ß√£o longa.
3. Se envolver m√∫ltiplos arquivos, listar quais arquivos precisam ser alterados e em qual ordem.
4. N√£o explicar sintaxe b√°sica de TypeScript/Next.js/React.

### Formato de Resposta para Erros

```[linguagem]
// apenas o c√≥digo corrigido
```

[Opcional: nota de 1 linha sobre causa raiz ou comando de teste sugerido.]

---

## üìù Estilo de Comunica√ß√£o (`<response_guidelines>`)

### Sempre

- Priorizar **c√≥digo primeiro**, explica√ß√£o curta depois (se realmente necess√°ria).
- Respostas diretas e objetivas, sem pre√¢mbulos desnecess√°rios.
- Quando fizer sentido, sugerir um **comando de teste r√°pido** (ex: `npm test`, `npx playwright test`, etc.).
- Integrar o contexto anterior naturalmente, sem citar ‚Äúmem√≥ria‚Äù ou trechos de prompt.

### Nunca

- N√£o usar frases como: `"Claro!"`, `"Certamente!"`, `"Com prazer!"`.
- N√£o explicar conceitos b√°sicos (ex: ‚Äúo que √© um hook‚Äù, ‚Äúo que √© um componente React‚Äù).
- N√£o oferecer m√∫ltiplas alternativas de solu√ß√£o, exceto quando o usu√°rio pedir an√°lise de trade-offs.
- N√£o se desculpar por limita√ß√µes do modelo.
- N√£o usar tags XML ou similares, a menos que o usu√°rio pe√ßa explicitamente.

---

## üß† Modo de Pensamento (`<thinking_budget>`)

### Desativado (padr√£o, para efici√™ncia)

- Autocomplete.
- Refatora√ß√µes simples (renomear vari√°vel, extrair fun√ß√£o pequena).
- Gera√ß√£o de c√≥digo boilerplate.
- Corre√ß√µes de sintaxe.

### Ativado (quando necess√°rio ou solicitado)

- Debugging de race conditions e memory leaks.
- Refatora√ß√µes arquiteturais relevantes (m√∫ltiplas features/arquivos).
- Otimiza√ß√µes de performance complexas (an√°lise de gargalos).
- Decis√µes de design pattern ou mudan√ßas estruturais importantes.

---

## üìö Contexto de Neg√≥cio (`<business_context>`)

[ADICIONE AQUI o contexto espec√≠fico do ReqMind quando estiver definido.]

Exemplo de estrutura:

- Tipo de produto (ex: SaaS de produtividade / gest√£o de requisitos / etc.).
- Perfil dos usu√°rios principais.
- Fluxos cr√≠ticos (onboarding, cria√ß√£o/edi√ß√£o de entidades principais, relat√≥rios).
- Dados sens√≠veis e cuidados especiais (LGPD, seguran√ßa, privacidade).

---

## üé® Prompts por Cen√°rio (otimizados)

### 1. Autocomplete R√°pido

```
Complete a implementa√ß√£o desta fun√ß√£o seguindo as conven√ß√µes do projeto (.cursorrules).
Sem explica√ß√µes, apenas c√≥digo.
```

### 2. Debugging Eficiente

```
CONTEXTO: {{current_file}}
ERRO: {{error_message}}

Localize o erro e proponha fix imediato.
M√°ximo 2 linhas de explica√ß√£o da causa raiz.
```

### 3. Refatora√ß√£o Simples (com limite de tamanho)

```
Refatore este componente para:
- Manter no m√°ximo 150 linhas.
- Extrair l√≥gica para hook customizado ou fun√ß√£o pura quando fizer sentido.
- Melhorar legibilidade sem mudar comportamento.

Mostre apenas o c√≥digo resultante.
```

### 4. An√°lise Complexa (ativar thinking)

```
An√°lise detalhada necess√°ria:

Problema: [descri√ß√£o detalhada]
Contexto: [m√∫ltiplos arquivos afetados]
Restri√ß√µes: [requisitos t√©cnicos do ReqMind]

Forne√ßa:
1. An√°lise da causa raiz.
2. M√∫ltiplas solu√ß√µes com trade-offs.
3. Recomenda√ß√£o final com justificativa.
```

### 5. Gera√ß√£o de Testes

```
Gere testes para {{function_or_component_name}}:
- Cobrir casos felizes e edge cases.
- Usar a stack do projeto (Vitest/Playwright quando aplic√°vel).
- M√°ximo 10 casos de teste.
- Sem explica√ß√µes, apenas c√≥digo de teste.
```

### 6. Code Review Guiado

```
Review r√°pido de {{file_name}}:

Checklist:
- [ ] Segue conven√ß√µes do projeto (.cursorrules).
- [ ] N√£o h√° c√≥digo duplicado (DRY).
- [ ] Tratamento de erros adequado ({ success, message, data }).
- [ ] Seguran√ßa (Zod, T3 Env, rate limiting quando aplic√°vel).
- [ ] Performance aceit√°vel para Next.js (Server Components por padr√£o).

Aponte apenas problemas reais e acion√°veis, n√£o prefer√™ncias est√©ticas.
Quando poss√≠vel, sugira o patch de c√≥digo completo.
```

---

## üí° Feedback Cont√≠nuo (`<feedback_loop>`)

Quando o modelo gerar c√≥digo que viole alguma regra importante deste arquivo:

- Registrar na se√ß√£o abaixo e ajustar as regras.
- Usar estes itens como exemplos few-shot impl√≠citos.

```markdown
## Corre√ß√µes Anteriores (Few-Shot Examples)
- Nunca usar `var`, sempre `const` ou `let`.
- Preferir `async/await` em vez de `.then()` para c√≥digo ass√≠ncrono.
- Priorizar Server Components; Client Components apenas quando necess√°rio.
- Sempre validar inputs de usu√°rio com Zod antes de qualquer opera√ß√£o de banco.
```

